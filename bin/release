#!/usr/bin/env bash
set -e

# Check if DATABASE_URL is set
if [ -z "$DATABASE_URL" ]; then
  echo "ERROR: DATABASE_URL is not set. Cannot run migrations."
  echo "Available environment variables:"
  env | grep -i database || echo "No DATABASE-related variables found"
  exit 1
fi

echo "Running database migrations with full trace..."
bundle exec rails db:migrate --trace
